Metadata-Version: 2.4
Name: hypo71py
Version: 0.1.0
Summary: Python implementation of the HYPO71 earthquake location algorithm
Author: Kris Vanneste, Dan Sandiford
Requires-Python: >=3.9
Description-Content-Type: text/markdown
Requires-Dist: numpy
Requires-Dist: scipy
Requires-Dist: pandas
Requires-Dist: obspy

# üêç Redbelly 

Redbelly is a Python-based (local) earthquake location python derived from the [robspy](https://gitlab-as.oma.be/kris/robspy) package‚Äôs `location` module. Acknowlegment goes to Kris Vanneste (other contributors to be added).  

The rationale for developing the code in this repository, is to provide a standalone tool that was not so heavily tied to `robspy`, and other associated packages.

The Redbelly package provides two complementary earthquake location algorithms ‚Äî a stochastic derivative-free global optimizer (hypo_inv) and a fast, fortran-accelerated iterative solver (hypo71). 

_Redbelly: The name comes from a reptile (Pseudechis porphyriacus) that is common in the South East of Victoria, the traditional lands of the Bunurong and Gunaikurnai, where our [seismic monitoring network](https://www.fdsn.org/networks/detail/VW/) is focussed._

-------------

‚öôÔ∏è 1. hypo_inv ‚Äî Basin-Hopping Method

hypo_inv implements a global search algorithm that combines:
	‚Ä¢	a basin-hopping method to explore parameter space broadly, and
	‚Ä¢	a local optimizer (e.g. L-BFGS-B or Nelder‚ÄìMead) to refine candidate minima.

This method treats the RMS residual (or another misfit metric) as an objective function and seeks the global minimum without requiring derivatives of travel-time with respect to model parameters.

Pros

* Robust to local minima ‚Äî useful for sparse, noisy, or poorly constrained networks.
* Flexible ‚Äî can use any forward model for travel times (analytic or TauP).
* Ideal for testing multiple velocity models or probabilistic (MCMC) sampling.

Cons

* Computationally expensive ‚Äî many forward evaluations per event (typically takes several seconds per event)
* Convergence speed depends on search space bounds and parameter scaling.

‚∏ª

‚öôÔ∏è 2. hypo71 ‚Äî Fortran-Accelerated Geiger Iterative Method

hypo71 performs iterative linearized least-squares inversion (a Geiger method) to adjust the hypocenter and origin time until travel-time residuals are minimized. It provides pure python versios of the key functions, while also wrapping a set of legacy Fortran subroutines from the original HYPO71 algorithm, accessed via f2py bindings.


Pros

* Fast ‚Äî orders of magnitude faster than basin-hopping.
* Proven and stable ‚Äî standard in operational earthquake cataloging.

Cons

* Can converge to local minima, especially with poor starting models.
Requires careful setup of velocity models and pick weighting schemes.


‚∏ª

‚ú® Current Features

* Hypocenter location from P/S arrival times in a 1-D layered crustal model
* Nonlinear optimization (COBYLA, L-BFGS-B, etc.) with optional global basin-hopping
* Layered travel-time computation and RMS misfit evaluation
* Clean, dependency-free implementation (NumPy, SciPy, ObsPy, PyProj)
* Expose the optimisation methods and parameters more cleanly
* Example notebook for synthetic tests and real event catalogs


‚∏ª

üöß Development Roadmap

The ongoing refactor aims to:

* Move into clear modules, eg, core, stochastic, gradient
* Add station corrections (SST, SSSTs)
* Add S-P inversion option 
* Demonstrate uses of refacted phases (velocity_model currently supports them)
* Replace legacy robspy data structures (e.g, PickList) with correspondign ObsPy classes (Station, Pick, Event, Catalog)
* Use hypo71 travel-time derivatives for gradient phase in hypo_inv (i.e allow coupling of the 2 core methods)
* Extend projection options beyond UTM and clarify geographic assumptions
* Improve performance of `hypo_inv` through vectorization and adaptive optimization controls
* Add more station weighting options (expose through a common submodule)
* Replace fortran optimisations with Numba



‚∏ª
